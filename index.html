<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reproductor CE - Quotes Sync</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <div class="player">
    <button id="themeToggle" class="theme-btn">üåì</button>
    <div class="cover"></div>
    <div class="quote" id="quoteText">Loading...</div>
    <div class="like" id="likeBtn">‚ô•</div>
    <audio id="audio" controls style="display:none;"></audio>

    <div class="progress-bar">
      <div class="progress" id="progress"></div>
    </div>

    <div class="controls">
      <button id="prevBtn">‚èÆÔ∏è</button>
      <button id="playPauseBtn">‚ñ∂Ô∏è</button>
      <button id="nextBtn">‚è≠Ô∏è</button>
    </div>
  </div>

  <!-- Folder structure expected:
       /audio/audio1.mp3, audio2.mp3, ...
       /captions/audio1.vtt, audio2.vtt, ... (optional)
       The JS array below maps each pair. If a .vtt is missing, static quote text shows. -->

  <div class="player" role="region" aria-label="CE Quotes Player">
    <div class="topbar">
      <div class="title">CE Quotes Player</div>
      <div class="spacer"></div>
      <button id="themeToggle" class="icon-btn" aria-label="Toggle theme">Theme</button>
    </div>

    <div class="cover" aria-hidden="true">Audio + Quotes Sync</div>

    <button id="likeBtn" class="like" aria-label="Toggle like" title="Like">‚ù§</button>

    <div class="quote-box" id="quoteBox" aria-live="polite">
      <div id="quoteText" class="quote">Loading‚Ä¶</div>
    </div>

    <div class="progress-wrap">
      <div class="bar" id="bar" aria-label="Seek bar" role="slider" aria-valuemin="0" aria-valuemax="100" aria-valuenow="0">
        <div class="bar-fill" id="barFill"></div>
      </div>
      <div class="time-row"><span id="tcur">0:00</span><span id="tdur">0:00</span></div>
    </div>

    <div class="controls">
      <button class="ctl" id="prevBtn" aria-label="Previous">‚èÆ</button>
      <button class="ctl primary" id="playPauseBtn" aria-label="Play / Pause">‚ñ∂</button>
      <button class="ctl" id="nextBtn" aria-label="Next">‚è≠</button>
    </div>

    <div class="bottom">
      <div class="chips">
        <span class="chip" id="chipShuffle" aria-pressed="false">Shuffle</span>
        <span class="chip" id="chipRepeat" aria-pressed="false">Repeat</span>
        <span class="chip" id="chipAutonext" aria-pressed="true">Autonext</span>
      </div>
      <div id="status">Track <span id="idx">1</span>/<span id="count">?</span></div>
    </div>

    <div class="playlist" id="playlist" aria-label="Playlist"></div>

    <audio id="audio" preload="metadata">
      <track id="captionTrack" kind="subtitles" srclang="en" label="Transcript" default>
    </audio>
  </div>

  <div>

<section class="menu">
  <div class="item">
    <h3>‚òï Coffee</h3>
    <p>Freshly brewed hot coffee</p>
    <p><strong>$2.50</strong></p>
    <input type="number" min="1" value="1" class="qty" id="coffeeQty">
    <button onclick="addToCart('Coffee', 2.5, document.getElementById('coffeeQty').value)">Add to Cart</button>
  </div>

  <div class="item">
    <h3>ü•ê Croissant</h3>
    <p>Buttery French pastry</p>
    <p><strong>$3.00</strong></p>
    <input type="number" min="1" value="1" class="qty" id="croissantQty">
    <button onclick="addToCart('Croissant', 3, document.getElementById('croissantQty').value)">Add to Cart</button>
  </div>

  <div class="item">
    <h3>ü•™ Breakfast Sandwich</h3>
    <p>Egg, cheese, and bacon on a roll</p>
    <p><strong>$5.00</strong></p>
    <input type="number" min="1" value="1" class="qty" id="sandwichQty">
    <button onclick="addToCart('Breakfast Sandwich', 5, document.getElementById('sandwichQty').value)">Add to Cart</button>
  </div>

  <div class="item">
    <h3>üçì Fruit Bowl</h3>
    <p>Fresh seasonal fruits</p>
    <p><strong>$4.00</strong></p>
    <input type="number" min="1" value="1" class="qty" id="fruitQty">
    <button onclick="addToCart('Fruit Bowl', 4, document.getElementById('fruitQty').value)">Add to Cart</button>
  </div>
</section>

<div>

<section class="menu" >

    <h2>I</h2>
  <blockquote>
    S√¨, Gregory, s√¨, √® quel volto, il corpo senza volto, no, il volto senza corpo, 
    il volto che vedi anche all‚Äôuniversit√†, s√¨, s√¨, Gregory, quel volto che non appartiene pi√π 
    a quella persona, ma alla tua mente. S√¨, √® proprio cos√¨, Gregory.  

    Ed √® come se volessi smettere di vederlo nelle persone, ma lo vedi ancora, √® geometrico, 
    s√¨, davvero lo √®, ma pi√π di questo, beh, ha la forma del suo volto (s√¨, il suo, s√¨, davvero √® il suo, Gregory).  

    E sul muro, con inchiostro nero, stava scritto:  
    Il mondo  
    sta crollando  
    ma nella forma  
    di un quadrato
  </blockquote>

  <h2>II</h2>
  <blockquote>
    Quella tecnica di scrivere prima un racconto, poi un romanzo e successivamente una commedia, 
    era una tradizione in tutta la sua famiglia (...)  

    Le fonti affidabili (raccolte dai testi di Edmundo nel Nuovo Mondo) dicono che gli incubi di Wagner 
    non erano stati altro che un incanto del non demiurgo e i mali della morte e la commedia che non scrisse [...]  

    Supplizio:  
    L‚Äôuomo dichiar√≤ che sua moglie era stata la donna pi√π pura della narrazione.  
    Secondo gli Onesti, quella donna conosceva i cammini sconosciuti, i colori delle bottiglie, 
    i sapori di un ‚ÄúBacio Proibito‚Äù (che probabilmente √® un film in bianco e nero)  
    o semplicemente la variante di un discorso mal pronunciato.  
  </blockquote>

  <h2>XIII</h2>
  <blockquote>
    L‚Äôenigma dei giusti fu negato dal sognatore del Cielo e, dopo sei notti, non vi fu traccia di fantasie;  
    i supplizi di tua madre e le grida degli astri non sono invecchiati come un vino 
    n√© nell‚ÄôInferno n√© nei nostri ricordi.
  </blockquote>

  <h2>IV</h2>
  <blockquote>
    Il Cielo si poteva immaginare forse come un suono elettronico o, se vogliamo essere giusti, come qualcosa di fittizio.  
    Ma non pu√≤ essere giusta la solitudine perch√© esiste l‚Äô‚ÄúAltro‚Äù (che allo stesso tempo lo nega) 
    ed √® il pi√π desiderato dagli uomini: L‚ÄôINFERNO.
  </blockquote>

  <h2>V</h2>
  <blockquote>
    In questa mattina senza nebbia siamo reali come una canzone di un tempo passato,  
    ma se forse ci svegliassimo non sapremmo neanche il nome.
  </blockquote>

  <h2>VI</h2>
  <blockquote>
    Non ebbi altra scelta che aprire lo zaino, tirare fuori la pistola e sparargli esattamente sotto l‚Äôocchio sinistro.  
    La scelta tra sinistro o destro non fu altro che un capriccio di una signora che indossava pantaloni rossi, 
    camicia bianca, scarpe nere (probabilmente di una marca lussuosa).  

    Nient‚Äôaltro che un oscuro desiderio di un problema iniziato nella terza settimana del 
    ‚ÄúGiorno dei Sogni e dei Giochi Assurdi‚Äù.  

    √à ormai ora di cena e il caff√® non ha zucchero.  
    Speriamo che dei sette canti scelti la notte precedente siano gi√† stati cantati tutti.
  </blockquote>

  <h2>VII</h2>
  <blockquote>
    Non si poteva pi√π scrivere alla macchina in questo modo perch√© cos√¨ gli avevano detto 
    in quella casa in cui tutti scrivevano cos√¨:  
    ‚ÄúAl ritmo del triangolo al ritmo di un‚Äôaltra figura simile (che evidentemente non era un triangolo, 
    forse era un Cane Nero o il nostro fallimento di brillare)‚Äù.
  </blockquote>

  <h2>VIII</h2>
  <blockquote>
    Se solo il Cielo fosse un po‚Äô pi√π celeste non avrei ragioni di vivere,  
    perch√© le forme si deformano negli autunni senza avvisare l‚Äôorfanezza che il tempo non ritorna.
  </blockquote>

  <h2>III X III X</h2>
  <blockquote>
    Cerca Dio, ma non lo trova.  
    Gli uomini dicono che siano passati sedici anni dalla Creazione di quel frammento piuttosto lucido 
    di quell‚Äôopera abbastanza surreale per un bambino della sua et√†.  

    COMPLETAMENTE PROIBITE LE CRONOLOGIE E LE BIBLIOGRAFIE.  

    I problemi non avevano a che fare con la Matematica, la Fisica o la scienza che serve ma non serve a nulla,  
    affinch√© il sogno appaia e di notte sia immediato, irrisolvibile e architettonico.  

    La finzione era necessaria per non morire di quella malattia che si chiama realt√†.  

    Parteciperanno a una festa e passeranno un foglietto sotto il tavolo e scriveranno qualcosa di bello.  
    Sar√† proibito inserire nome e firma (o qualsiasi tipo di legame con l‚Äôautore).  

    Si sono sempre chiesti il perch√© di tale azione. ‚ÄúNon lo sapranno mai‚Äù, 
    ma √® gi√† stata raccontata nei racconti, nelle melodie e nei luoghi solitari.
  </blockquote>

  <h2>XX</h2>
  <blockquote>
    Non si pu√≤ articolare linguaggio senza diagnosi n√© rimedi che conservano diari, date e almanacchi di anni dimenticati.  

    Ho imparato dai sogni di una croce.  
    La croce non aveva nome ed era un atto vergognoso.
  </blockquote>

  <h2>1828</h2>
  <blockquote>
    Solo il sognatore eterno pu√≤ sentire ci√≤ che chiamano conoscere i demoni del Cielo, che sanno volare in aereo.  

    Quelli dei sogni, delle tradizioni, miti o leggende.  
    Quelli dei romanzi fantasmagorici di voli ultraterreni verso il Vecchio Continente.  

    E come dimenticare i geni delle piramidi che compresero la Statistica, il ritmo dell‚Äôaria e il suono del silenzio.  

    E sopra ogni cosa trovarono l‚Äôamore non in un altro essere (per nulla filosofico) 
    ma nei petali delle rose di quell‚Äôalbero che piant√≤, il libro che non scrisse e il figlio che non ebbe.  

    Mise anche enfasi su un amico che non arriv√≤ mai a conoscere.  

    Diceva sempre che aveva gi√† scritto tutto nel suo quaderno e che lo aveva anche duplicato, 
    come una di quelle porte che tutti sanno aprire o (se non lo sanno) la aprono usando l‚ÄôAritmetica, 
    come in un colpo cinematografico americano che neanche io ricordo.
  </blockquote>

  <h2>1919</h2>
  <blockquote>
    Scrivevo versi nella mia stanza mentre mia madre lavorava a maglia in salotto, godendosi la sua vita senile 
    che lentamente giungeva alla fine.  

    Con la matita nella sinistra e l‚Äôalcol nella destra, terminavo una poesia per lei (e, quando dico lei, 
    non mi riferisco a mia madre, ma alla ragazza che conobbi quell‚Äôestate del ‚Äô16).  

    Dolore e gioia mi erano gi√† capitati, e so che nessuno li ha vissuti come me.  

    In quell‚Äôatmosfera cupa, dove una lampada illuminava la mia scrivania e i ricordi provocavano cataclismi 
    in ogni angolo della mia mente, la idealizzavo e ne godevo; forse con lacrime o gioia.  

    ‚ÄúL‚Äôhai amata e l‚Äôhai ripagata con il male? Se un giorno la incontrerai, anche se probabilmente non accadr√†, 
    dille che la ami e che speravi che non arrivasse; perch√© complicata √® la situazione di chi maltratta con amore, 
    piange sorridendo e non pu√≤ chiedere perdono.‚Äù  

    Il vento sussurrava, quieto, dalla finestra della stanza e l‚Äôalcol faceva il suo lavoro: imprigionare il cuore.  

    Era passata una settimana dalla sua morte; non potevo sopportare pi√π la colpa.  
    L‚Äôho uccisa, s√¨, e l‚Äôho fatto con amore. So che era la scelta migliore; nessun‚Äôaltra pena avrebbe pagato ci√≤ che mi fece.  

    Quei versi intensi causarono un vasto cammino di ricordi, la mia demenza aument√≤ e la morte fu la mia via d‚Äôuscita.  

    E ora non so da dove sto scrivendo; forse da un luogo dell‚Äôinferno dove vaga la mia anima perduta.  

    Dolce incubo d‚Äôestate romantica, quanto ti odio e quanto ti amo!
  </blockquote>

  <h2>Due Inferni I</h2>
  <blockquote>
    Mi ricorder√≤ sempre di te (solo per quel modo speciale di intrecciare le dita)  
    e mi ricorder√≤ sempre di te (forse per quel suono assurdo del duemilanove)  

    e mi ricorder√≤ solo di te perch√© resta poco tempo, poco, pochissimo tempo prima che si sveglino.
  </blockquote>

  <h2>Due Inferni II</h2>
  <blockquote>
    √à difficile dimenticare che sono stato protagonista di quelle conversazioni in cui ascoltavamo 
    Lucy in the Sky with Diamonds e che avevano anche odore di pancake bruciati.  

    E il caff√® non aveva sapore dolce, e il caff√® non aveva nemmeno latte, e il caff√® non era caff√®,  
    perch√© la campana suonava come un tic-tac nel corridoio.  

    E s√¨ (lo ripeter√≤ sette volte ancora: s√¨), era tutto alle sei del mattino,  
    prima che passasse il tram, prima che il cigno si intimorisse e prima che sognassero gli stomaci.
  </blockquote>

  <h2>2000</h2>
  <blockquote>
    Gregory √® seduto, ma ha fame ed √® al verde (in pi√π √® gi√† moralmente sconfitto).  
    Sono le tre e un quarto e non ha ancora pranzato.  

    Gli hanno gi√† detto le stesse cose pi√π di quattro volte: che √® un idiota, che nessuno lo amer√† mai, che √® inutile,  
    e che da vecchio non sorrider√† mai.  

    Non avr√† capelli, e le sue ossa saranno disgustose come quelle di qualsiasi altro discepolo o principiante.  

    La mia fantasia prende forma in 4 spazi silenziosi.
  </blockquote>

</section>



</div>



<style>
  .menu {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 1.2rem;
    padding: 1rem;
  }
  .item {
    background: #fff;
    border-radius: 12px;
    padding: 1rem;
    text-align: center;
    box-shadow: 0 3px 8px rgba(0,0,0,0.1);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  .item:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 14px rgba(0,0,0,0.15);
  }
  .item h3 { margin: 0.5rem 0; }
  .item input.qty {
    width: 60px;
    text-align: center;
    margin: 0.5rem 0;
    padding: 0.3rem;
    border-radius: 5px;
    border: 1px solid #ccc;
  }
  .item button {
    background: #ff9f43;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.2s, transform 0.1s;
  }
  .item button:hover {
    background: #ff6f00;
  }
  .item button:active {
    transform: scale(0.95);
  }
</style>

  

  <script>
    // ---------- Data ----------
    const tracks = [
      { id: 'audio1', quote: `Grego acquires a .38 Special and has planned the greatest of all his Neolithic adventures.\nHe‚Äôs still clumsy with the .38, but he‚Äôs mastered the Desert Eagle and loves the sound of the shell rain.`, audio: './audio/audio1.mp3', vtt: './captions/audio1.vtt' },
      { id: 'audio2', quote: `Regarding the unresolved process, the woman has not asked about anyone again, neither her daughter nor any specific person.\nShe said she didn't have a phone number, but ‚Äîin alternate and metaphysical realities‚Äî she was in a dream.`, audio: './audio/audio2.mp3', vtt: './captions/audio2.vtt' },
      { id: 'audio3', quote: `Her composition has been the greatest enigma of the people, and there was no return.\nBut‚Ä¶ that illness is common in his family!`, audio: './audio/audio3.mp3', vtt: './captions/audio3.vtt' },
      { id: 'audio4', quote: `Truly ‚Äî although many say otherwise ‚Äî the discomfort was always present.\nIt appeared on the antipodes of the figure, and despite so much effort, always the other side contradicted it.\nNo\nbut\nyes`, audio: './audio/audio4.mp3', vtt: './captions/audio4.vtt' },
      { id: 'audio5', quote: `He realized that the sound in which he would meet Rafaela before dying had already described itself.\nYes, it described itself in that sixteen we all know, it has a steady rhythm.\nIt‚Äôs the blend of the sound of a sphere that does not exist within time.`, audio: './audio/audio5.mp3', vtt: './captions/audio5.vtt' },
      { id: 'audio6', quote: `Time, little time ‚Äî we hate the time that saw us born and will see us die, yet will never leave us with the same faces.`, audio: './audio/audio6.mp3', vtt: './captions/audio6.vtt' },
      { id: 'audio7', quote: `The sound is enough, Grego. Think: the music of the spheres.`, audio: './audio/audio7.mp3', vtt: './captions/audio7.vtt' },
    ];

    // ---------- Elements ----------
    const audio = document.getElementById('audio');
    const trackEl = document.getElementById('captionTrack');
    const playBtn = document.getElementById('playPauseBtn');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const likeBtn = document.getElementById('likeBtn');
    const themeToggle = document.getElementById('themeToggle');
    const quoteText = document.getElementById('quoteText');
    const quoteBox = document.getElementById('quoteBox');
    const bar = document.getElementById('bar');
    const barFill = document.getElementById('barFill');
    const tcur = document.getElementById('tcur');
    const tdur = document.getElementById('tdur');
    const idxEl = document.getElementById('idx');
    const countEl = document.getElementById('count');
    const playlist = document.getElementById('playlist');

    // ---------- State ----------
    let i = 0; // current index
    let shuffle = false; let repeat = false; let autonext = true;
    const LIKES_KEY = 'ce.quote.likes';
    const LAST_KEY = 'ce.quote.last';

    countEl.textContent = tracks.length;

    // ---------- Helpers ----------
    const fmt = s => {
      if (!Number.isFinite(s)) return '0:00';
      const m = Math.floor(s/60), r = Math.floor(s%60);
      return m + ':' + String(r).padStart(2,'0');
    }

    function saveLast() {
      try { localStorage.setItem(LAST_KEY, JSON.stringify({ i, t: audio.currentTime })); } catch(_){}
    }
    function restoreLast() {
      try { const v = JSON.parse(localStorage.getItem(LAST_KEY)||'null'); if (v && tracks[v.i]) { i = v.i; setTrack(i, false); audio.currentTime = v.t||0; } } catch(_){}
    }

    function isLiked(id){ try { const set = new Set(JSON.parse(localStorage.getItem(LIKES_KEY)||'[]')); return set.has(id);} catch(_) { return false; } }
    function toggleLike(id){
      try {
        const arr = JSON.parse(localStorage.getItem(LIKES_KEY)||'[]');
        const set = new Set(arr);
        if (set.has(id)) set.delete(id); else set.add(id);
        localStorage.setItem(LIKES_KEY, JSON.stringify([...set]));
        likeBtn.classList.toggle('liked', set.has(id));
      } catch(_){}
    }

    function renderPlaylist(){
      playlist.innerHTML = '';
      tracks.forEach((t, k) => {
        const row = document.createElement('div');
        row.className = 'row' + (k===i ? ' active' : '');
        row.innerHTML = `<div>${k+1}. <strong>${t.id}</strong></div><small>${t.audio.split('/').pop()}</small>`;
        row.addEventListener('click', () => { setTrack(k, true); });
        playlist.appendChild(row);
      });
    }

    function renderQuoteStatic(){
      // Render static text split by newlines as simple paragraphs
      quoteText.innerHTML = '';
      const parts = String(tracks[i].quote || '').split(/\n/);
      for (const p of parts) {
        const span = document.createElement('span');
        span.className = 'cue'; span.textContent = p; quoteText.appendChild(span); quoteText.appendChild(document.createElement('br'));
      }
    }

    function setTrack(k, autoPlay=false){
      i = k; idxEl.textContent = i+1; renderPlaylist();
      likeBtn.classList.toggle('liked', isLiked(tracks[i].id));
      audio.src = tracks[i].audio; audio.load();

      // load VTT if present
      if (tracks[i].vtt) {
        trackEl.src = tracks[i].vtt; // attach to <audio>
        // Some browsers need a small delay before accessing textTracks
        setTimeout(attachCueHandlers, 50);
      } else {
        trackEl.src = '';
        renderQuoteStatic();
      }

      if (autoPlay) play();
    }

    function attachCueHandlers(){
      const list = audio.textTracks; if (!list || list.length===0) { renderQuoteStatic(); return; }
      const tt = list[0]; tt.mode = 'hidden'; // so cues are available programmatically
      // Pre-render all cues for scrollable highlighting
      quoteText.innerHTML = '';
      const map = new Map();
      for (const cue of tt.cues || []) {
        const s = document.createElement('span'); s.className = 'cue'; s.textContent = cue.text; s.dataset.start = cue.startTime; s.dataset.end = cue.endTime; quoteText.appendChild(s); quoteText.appendChild(document.createTextNode(' '));
        map.set(cue, s);
        // Seek on click
        s.addEventListener('click', () => { audio.currentTime = cue.startTime + 0.01; });
      }
      tt.oncuechange = () => {
        // Clear
        for (const [cue, el] of map.entries()) el.classList.toggle('active', false);
        for (const cue of tt.activeCues || []) {
          const el = map.get(cue); if (el) { el.classList.add('active'); el.scrollIntoView({ block:'nearest', inline:'nearest' }); }
        }
      };
    }

    function play(){ audio.play(); playBtn.textContent='‚è∏'; }
    function pause(){ audio.pause(); playBtn.textContent='‚ñ∂'; }

    // ---------- Events ----------
    playBtn.addEventListener('click', () => audio.paused ? play() : pause());
    prevBtn.addEventListener('click', () => { if (audio.currentTime>3) { audio.currentTime = 0; } else { setTrack((i-1+tracks.length)%tracks.length, true); } });
    nextBtn.addEventListener('click', () => { setTrack((i+1)%tracks.length, true); });

    likeBtn.addEventListener('click', () => toggleLike(tracks[i].id));

    themeToggle.addEventListener('click', () => document.body.classList.toggle('light'));

    audio.addEventListener('timeupdate', () => {
      if (!Number.isFinite(audio.duration)) return;
      const p = (audio.currentTime / audio.duration) * 100;
      barFill.style.inset = `0 ${Math.max(0,100-p)}% 0 0`;
      bar.setAttribute('aria-valuenow', Math.round(p));
      tcur.textContent = fmt(audio.currentTime); tdur.textContent = fmt(audio.duration);
      saveLast();
    });

    audio.addEventListener('ended', () => {
      if (repeat) { audio.currentTime = 0; play(); return; }
      if (autonext) {
        if (shuffle) {
          let n; do { n = Math.floor(Math.random()*tracks.length); } while (n===i && tracks.length>1);
          setTrack(n, true);
        } else {
          setTrack((i+1)%tracks.length, true);
        }
      } else {
        pause();
      }
    });

    // Progress scrubbing
    function seekFromEvent(evt){
      const rect = bar.getBoundingClientRect();
      const p = Math.min(Math.max((evt.clientX - rect.left)/rect.width, 0), 1);
      if (Number.isFinite(audio.duration)) audio.currentTime = p * audio.duration;
    }
    bar.addEventListener('click', seekFromEvent);

    // Keyboard shortcuts
    window.addEventListener('keydown', (e) => {
      if (e.target && ['INPUT','TEXTAREA'].includes(e.target.tagName)) return;
      if (e.code === 'Space') { e.preventDefault(); audio.paused ? play() : pause(); }
      if (e.code === 'ArrowRight') { audio.currentTime = Math.min((audio.currentTime||0) + 5, audio.duration||1e9); }
      if (e.code === 'ArrowLeft') { audio.currentTime = Math.max((audio.currentTime||0) - 5, 0); }
      if (e.key.toLowerCase() === 'l') { toggleLike(tracks[i].id); }
    });

    // Chips
    function toggleChip(el, flag){ el.classList.toggle('active', flag); el.setAttribute('aria-pressed', String(flag)); }
    const chipShuffle = document.getElementById('chipShuffle');
    const chipRepeat  = document.getElementById('chipRepeat');
    const chipAutonext= document.getElementById('chipAutonext');
    chipShuffle.addEventListener('click', () => { shuffle = !shuffle; toggleChip(chipShuffle, shuffle); });
    chipRepeat.addEventListener('click',  () => { repeat  = !repeat;  toggleChip(chipRepeat,  repeat);  });
    chipAutonext.addEventListener('click',() => { autonext = !autonext; toggleChip(chipAutonext, autonext); });

    // ---------- Init ----------
    renderPlaylist();
    setTrack(0, false);
    restoreLast();
    renderPlaylist();
  </script>



  <script src="script.js"></script>
</body>
</html>
